{"ast":null,"code":"import _defineProperty from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import firebase from\"./../../config\";import{Card,CardBody,CardHeader,Col,Row,Table,CardImg,Badge,Button}from\"reactstrap\";import{AppSwitch}from\"@coreui/react\";import ChartTeams from\"./ChartTeams\";import TableTeams from\"./TableTeams\";import OldMatch from\"./OldMatch\";import moment from\"moment\";var scrollToRef=function scrollToRef(ref){return ref.current.scrollIntoView({behavior:\"smooth\",block:\"start\"});};var Random=function Random(_ref){var changeStatusProgress=_ref.changeStatusProgress;var myRef=useRef(null);var ref=firebase.database();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),teams=_useState4[0],setTeams=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),oldMatch=_useState6[0],setOldMatch=_useState6[1];useEffect(function(){changeStatusProgress(true);ref.ref(\"users\").orderByValue().on(\"value\",function(snap){changeStatusProgress(false);setUsers(Object.values(snap.val()).map(function(user){return _objectSpread({},user,{checked:false});}));});ref.ref(\"historyRandom\").orderByValue().limitToLast(1).on(\"value\",function(snap){changeStatusProgress(false);if(snap.val()!==null&&!Object.values(snap.val())[0].complete){setOldMatch(Object.values(snap.val())[0]);}});},[]);var statisticPlayer=function statisticPlayer(player){return users.find(function(user){return user.ingame===player;});};useEffect(function(){scrollToRef(myRef);},[teams]);var lastInfoTeam=function lastInfoTeam(){var _ref2;var t1=teams[0]&&teams[0].map(function(i){var player=i.split(\" - \")[0];var addStatistic=i+\" - \"+statisticPlayer(player).win+\" - \"+statisticPlayer(player).lose+\" - \"+statisticPlayer(player).avatar;return addStatistic;});var t2=teams[1]&&teams[1].map(function(i){var player=i.split(\" - \")[0];var addStatistic=i+\" - \"+statisticPlayer(player).win+\" - \"+statisticPlayer(player).lose+\" -  \"+statisticPlayer(player).avatar;return addStatistic;});return _ref2={},_defineProperty(_ref2,0,t1),_defineProperty(_ref2,1,t2),_ref2;};var handleSplitTeam=function handleSplitTeam(){var teams=users.filter(function(i){return i.checked;});var names=teams.map(function(i){return i.ingame;});var details=teams.reduce(function(acc,cur){return _objectSpread({},acc,_defineProperty({},cur.ingame,cur.role));},{});var random=function random(){return~~(Math.random()*5);};var isFull=function isFull(team){return team.length===5;};var renderLane=function renderLane(player,team){try{var rLane=details[player][random()];if(!rLane||team.some(function(i){return i.includes(rLane);})){return renderLane(player,team);}return\"\".concat(player,\" - \").concat(rLane);}catch(err){return handleSplitTeam();}};var splitTeam=names.reduce(function(acc,cur){if(isFull(acc[0])||isFull(acc[1])){isFull(acc[0])?acc[1].push(renderLane(cur,acc[1])):acc[0].push(renderLane(cur,acc[1]));}else{var r=random()%2;acc[r].push(renderLane(cur,acc[r]));}return acc;},{\"0\":[],\"1\":[]});if(splitTeam[0].filter(Boolean).length===5&&splitTeam[1].filter(Boolean).length===5){setTeams(splitTeam);}};var renderUser=function renderUser(){return users.map(function(user,index){return React.createElement(\"tr\",{key:user.username},React.createElement(\"td\",null,index+1),React.createElement(\"td\",null,user.avatar&&React.createElement(CardImg,{style:{width:\"30px\"},src:user.avatar,alt:\"avatar\"})),React.createElement(\"td\",null,user.ingame),React.createElement(\"td\",null,user.role&&user.role.map(function(r){return React.createElement(\"span\",{key:user.username+r},r,\", \");})),React.createElement(\"td\",null,user.win),React.createElement(\"td\",null,user.lose),React.createElement(\"td\",null,~~(user.win/(user.win+user.lose)*100||0),\" \",React.createElement(\"small\",null,\"%\")),React.createElement(\"td\",null,React.createElement(AppSwitch,{className:\"mx-1\",color:\"success\",checked:user.checked,disabled:handleTotalSelected()===10&&!user.checked||!user.role||!user.role.length,onChange:function onChange(_ref3){var checked=_ref3.target.checked;setUsers(function(prev){return prev.map(function(p){if(p.username===user.username){p.checked=checked;}return p;});});}})));});};var handleTotalSelected=function handleTotalSelected(){return users.filter(function(i){return i.checked;}).length;};var handleSaveTeamRandom=function handleSaveTeamRandom(){changeStatusProgress(true);var statistic={blueTeam:teams[0],redTeam:teams[1],dateMatch:moment(new Date()).format(\"YYYY-MM-DD\"),complete:false,authorCreate:JSON.parse(localStorage.getItem(\"account\")).username,authorUpdate:''};ref.ref(\"historyRandom\").push(statistic,function(snap){changeStatusProgress(false);});setOldMatch(statistic);};if(oldMatch.complete===false)return React.createElement(OldMatch,{oldMatch:oldMatch,changeStatusProgress:changeStatusProgress});return React.createElement(Row,null,React.createElement(Col,null,React.createElement(Card,null,React.createElement(CardHeader,null,React.createElement(\"i\",{className:\"fa fa-align-justify\"}),\" Users table\"),React.createElement(CardBody,null,React.createElement(\"h4\",null,\"Player selected\",\" \",React.createElement(Badge,{color:handleTotalSelected()===10?\"success\":\"secondary\"},handleTotalSelected())),handleTotalSelected()!==10&&React.createElement(\"small\",null,\"Choose 10 players from the board\")||React.createElement(\"small\",null,\"Picked enough\"),React.createElement(Table,{hover:true,bordered:true,striped:true,responsive:true,size:\"sm\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"#\"),React.createElement(\"th\",null,\"Avatar\"),React.createElement(\"th\",null,\"Player\"),React.createElement(\"th\",null,\"Role\"),React.createElement(\"th\",null,\"Win\"),React.createElement(\"th\",null,\"Lost\"),React.createElement(\"th\",null,\"Win rate \",React.createElement(\"small\",null,\"(%)\")),React.createElement(\"th\",null,\"Status\"))),React.createElement(\"tbody\",null,renderUser())),React.createElement(Row,null,React.createElement(Col,{col:\"6\",sm:\"4\",md:\"3\",xl:\"2\",className:\"mb-3 mb-xl-0\"},React.createElement(Button,{block:true,color:\"success\",disabled:handleTotalSelected()!==10,onClick:handleSplitTeam},\"Random team\"))),React.createElement(\"div\",{ref:myRef},teams&&JSON.stringify(teams)!==\"{}\"&&React.createElement(React.Fragment,null,React.createElement(TableTeams,{teams:lastInfoTeam()}),React.createElement(ChartTeams,{teams:lastInfoTeam()}),React.createElement(Row,null,React.createElement(Col,{col:\"6\",sm:\"4\",md:\"3\",xl:\"2\",className:\"mb-3 mb-xl-0\"},React.createElement(Button,{block:true,color:\"success\",onClick:handleSaveTeamRandom},\"Save Team\")))))))));};export default Random;","map":{"version":3,"sources":["/Users/maidat/Desktop/untitled folder/persol-lqmb/src/components/Random/index.js"],"names":["React","useState","useEffect","useRef","firebase","Card","CardBody","CardHeader","Col","Row","Table","CardImg","Badge","Button","AppSwitch","ChartTeams","TableTeams","OldMatch","moment","scrollToRef","ref","current","scrollIntoView","behavior","block","Random","changeStatusProgress","myRef","database","users","setUsers","teams","setTeams","oldMatch","setOldMatch","orderByValue","on","snap","Object","values","val","map","user","checked","limitToLast","complete","statisticPlayer","player","find","ingame","lastInfoTeam","t1","i","split","addStatistic","win","lose","avatar","t2","handleSplitTeam","filter","names","details","reduce","acc","cur","role","random","Math","isFull","team","length","renderLane","rLane","some","includes","err","splitTeam","push","r","Boolean","renderUser","index","username","width","handleTotalSelected","target","prev","p","handleSaveTeamRandom","statistic","blueTeam","redTeam","dateMatch","Date","format","authorCreate","JSON","parse","localStorage","getItem","authorUpdate","stringify"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport firebase from \"./../../config\";\nimport {\n  Card,\n  CardBody,\n  CardHeader,\n  Col,\n  Row,\n  Table,\n  CardImg,\n  Badge,\n  Button\n} from \"reactstrap\";\nimport { AppSwitch } from \"@coreui/react\";\nimport ChartTeams from \"./ChartTeams\";\nimport TableTeams from \"./TableTeams\";\nimport OldMatch from \"./OldMatch\";\nimport moment from \"moment\";\n\nconst scrollToRef = ref =>\n  ref.current.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\nconst Random = ({ changeStatusProgress }) => {\n  const myRef = useRef(null);\n  const ref = firebase.database();\n  const [users, setUsers] = useState([]);\n  const [teams, setTeams] = useState({});\n  const [oldMatch, setOldMatch] = useState({});\n\n  useEffect(() => {\n    changeStatusProgress(true);\n    ref\n      .ref(\"users\")\n      .orderByValue()\n      .on(\"value\", snap => {\n        changeStatusProgress(false);\n        setUsers(\n          Object.values(snap.val()).map(user => ({ ...user, checked: false }))\n        );\n      });\n      \n    ref\n      .ref(\"historyRandom\")\n      .orderByValue()\n      .limitToLast(1)\n      .on(\"value\", snap => {\n        changeStatusProgress(false);\n        if (snap.val() !== null && !Object.values(snap.val())[0].complete) {\n          setOldMatch(Object.values(snap.val())[0]);\n        }\n      });\n  }, []);\n  \n  const statisticPlayer = player => users.find(user => user.ingame === player);\n\n  useEffect(() => {\n    scrollToRef(myRef);\n  }, [teams]);\n\n  const lastInfoTeam = () => {\n    const t1 =\n      teams[0] &&\n      teams[0].map(i => {\n        const player = i.split(\" - \")[0];\n        const addStatistic =\n          i +\n          \" - \" +\n          statisticPlayer(player).win +\n          \" - \" +\n          statisticPlayer(player).lose +\n          \" - \" +\n          statisticPlayer(player).avatar;\n        return addStatistic;\n      });\n    const t2 =\n      teams[1] &&\n      teams[1].map(i => {\n        const player = i.split(\" - \")[0];\n        const addStatistic =\n          i +\n          \" - \" +\n          statisticPlayer(player).win +\n          \" - \" +\n          statisticPlayer(player).lose +\n          \" -  \" +\n          statisticPlayer(player).avatar;\n        return addStatistic;\n      });\n    return { [0]: t1, [1]: t2 };\n  };\n\n  const handleSplitTeam = () => {\n    const teams = users.filter(i => i.checked);\n    const names = teams.map(i => i.ingame);\n    const details = teams.reduce(\n      (acc, cur) => ({ ...acc, [cur.ingame]: cur.role }),\n      {}\n    );\n\n    const random = () => ~~(Math.random() * 5);\n\n    const isFull = team => team.length === 5;\n\n    const renderLane = (player, team) => {\n      try {\n        const rLane = details[player][random()];\n        if (!rLane || team.some(i => i.includes(rLane))) {\n          return renderLane(player, team);\n        }\n        return `${player} - ${rLane}`;\n      } catch (err) {\n        return handleSplitTeam();\n      }\n    };\n\n    const splitTeam = names.reduce(\n      (acc, cur) => {\n        if (isFull(acc[0]) || isFull(acc[1])) {\n          isFull(acc[0])\n            ? acc[1].push(renderLane(cur, acc[1]))\n            : acc[0].push(renderLane(cur, acc[1]));\n        } else {\n          const r = random() % 2;\n          acc[r].push(renderLane(cur, acc[r]));\n        }\n        return acc;\n      },\n      { \"0\": [], \"1\": [] }\n    );\n\n    if (\n      splitTeam[0].filter(Boolean).length === 5 &&\n      splitTeam[1].filter(Boolean).length === 5\n    ) {\n      setTeams(splitTeam);\n    }\n  };\n\n  const renderUser = () => {\n    return users.map((user, index) => {\n      return (\n        <tr key={user.username}>\n          <td>{index + 1}</td>\n          <td>\n            {user.avatar && (\n              <CardImg\n                style={{ width: \"30px\" }}\n                src={user.avatar}\n                alt=\"avatar\"\n              />\n            )}\n          </td>\n          <td>{user.ingame}</td>\n          <td>\n            {user.role && user.role.map(r => (\n              <span key={user.username + r}>{r}, </span>\n            ))}\n          </td>\n          <td>{user.win}</td>\n          <td>{user.lose}</td>\n          <td>\n            {~~((user.win / (user.win + user.lose)) * 100 || 0)} <small>%</small>\n          </td>\n          <td>\n            <AppSwitch\n              className={\"mx-1\"}\n              color={\"success\"}\n              checked={user.checked}\n              disabled={handleTotalSelected() === 10 && !user.checked || (!user.role || !user.role.length)}\n              onChange={({ target: { checked } }) => {\n                setUsers(prev =>\n                  prev.map(p => {\n                    if (p.username === user.username) {\n                      p.checked = checked;\n                    }\n                    return p;\n                  })\n                );\n              }}\n            />\n          </td>\n        </tr>\n      );\n    });\n  };\n\n  const handleTotalSelected = () => {\n    return users.filter(i => i.checked).length;\n  };\n\n  const handleSaveTeamRandom = () => {\n    changeStatusProgress(true);\n    const statistic = {\n      blueTeam: teams[0],\n      redTeam: teams[1],\n      dateMatch: moment(new Date()).format(\"YYYY-MM-DD\"),\n      complete: false,\n      authorCreate: JSON.parse(localStorage.getItem(\"account\")).username,\n      authorUpdate: ''\n    };\n\n    ref.ref(\"historyRandom\").push(statistic, snap => {\n      changeStatusProgress(false);\n    });\n    setOldMatch(statistic);\n  };\n\n  if(oldMatch.complete === false) return <OldMatch oldMatch={oldMatch} changeStatusProgress={changeStatusProgress}/>\n\n  return (\n    <Row>\n      <Col>\n        <Card>\n          <CardHeader>\n            <i className=\"fa fa-align-justify\"></i> Users table\n          </CardHeader>\n          <CardBody>\n            <h4>\n              Player selected{\" \"}\n              <Badge\n                color={handleTotalSelected() === 10 ? \"success\" : \"secondary\"}\n              >\n                {handleTotalSelected()}\n              </Badge>\n            </h4>\n            {(handleTotalSelected() !== 10 && (\n              <small>Choose 10 players from the board</small>\n            )) || <small>Picked enough</small>}\n            <Table hover bordered striped responsive size=\"sm\">\n              <thead>\n                <tr>\n                  <th>#</th>\n                  <th>Avatar</th>\n                  <th>Player</th>\n                  <th>Role</th>\n                  <th>Win</th>\n                  <th>Lost</th>\n                  <th>\n                    Win rate <small>(%)</small>\n                  </th>\n                  <th>Status</th>\n                </tr>\n              </thead>\n              <tbody>{renderUser()}</tbody>\n            </Table>\n            <Row>\n              <Col col=\"6\" sm=\"4\" md=\"3\" xl=\"2\" className=\"mb-3 mb-xl-0\">\n                <Button\n                  block\n                  color=\"success\"\n                  disabled={handleTotalSelected() !== 10}\n                  onClick={handleSplitTeam}\n                >\n                  Random team\n                </Button>\n              </Col>\n            </Row>\n            <div ref={myRef}>\n              {teams && JSON.stringify(teams) !== \"{}\" && (\n                <>\n                  <TableTeams teams={lastInfoTeam()} />\n                  <ChartTeams teams={lastInfoTeam()} />\n                  <Row>\n                    <Col col=\"6\" sm=\"4\" md=\"3\" xl=\"2\" className=\"mb-3 mb-xl-0\">\n                      <Button\n                        block\n                        color=\"success\"\n                        onClick={handleSaveTeamRandom}\n                      >\n                        Save Team\n                      </Button>\n                    </Col>\n                  </Row>\n                </>\n              )}\n            </div>\n          </CardBody>\n        </Card>\n      </Col>\n    </Row>\n  );\n};\n\nexport default Random;\n"]},"metadata":{},"sourceType":"module"}
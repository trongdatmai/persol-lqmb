{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useState}from\"react\";import{Button,Card,CardBody,CardFooter,Col,Container,Form,Input,InputGroup,InputGroupAddon,InputGroupText,Row}from\"reactstrap\";import firebase from\"./../../../config\";import{useHistory}from\"react-router-dom\";var styleErr={border:\"1px solid #FF3300\"};var styleExists={color:'#FF3300',display:'block'};function sleep(time){return new Promise(function(resolve){return setTimeout(resolve,time);});}var Register=function Register(){var history=useHistory();var _useState=useState({username:\"\",password:\"\",repPassword:\"\",win:0,lose:0}),_useState2=_slicedToArray(_useState,2),account=_useState2[0],setAccout=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),err=_useState4[0],setErr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];var handleRegister=function handleRegister(){var e,ref;return _regeneratorRuntime.async(function handleRegister$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e=false;if(account.repPassword!==account.password||!account.password){setErr(function(prev){return _objectSpread({},prev,{password:true});});e=true;}if(!account.username&&!account.username.trim()){setErr(function(prev){return _objectSpread({},prev,{username:true});});e=true;}if(!e){_context2.next=5;break;}return _context2.abrupt(\"return\");case 5:_context2.next=7;return _regeneratorRuntime.awrap(setDisabled(true));case 7:ref=firebase.database();ref.ref(\"users\").orderByChild(\"username\").equalTo(account.username).on(\"value\",function _callee(snapshot){var key,childData;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(snapshot.val()===null)){_context.next=9;break;}account.avatar='https://image.flaticon.com/icons/svg/2439/2439789.svg';_context.next=4;return _regeneratorRuntime.awrap(setAccout(function(prev){delete prev.repPassword;return prev;}));case 4:ref.ref(\"users\").push(account);localStorage.setItem('account',JSON.stringify(account));history.push('/user/profile');_context.next=13;break;case 9:setErr(function(prev){return _objectSpread({},prev,{exist:true});});setDisabled(false);key=snapshot.key;childData=snapshot.val();case 13:case\"end\":return _context.stop();}}});});// firebase.database().ref('users').push(account);\ncase 9:case\"end\":return _context2.stop();}}});};return React.createElement(\"div\",{className:\"app flex-row align-items-center\"},React.createElement(Container,null,React.createElement(Row,{className:\"justify-content-center\"},React.createElement(Col,{md:\"9\",lg:\"7\",xl:\"6\"},React.createElement(Card,{className:\"mx-4\"},React.createElement(CardBody,{className:\"p-4\"},React.createElement(Form,null,React.createElement(\"h1\",null,\"Register\"),React.createElement(\"p\",{className:\"text-muted\"},\"Create your account\"),React.createElement(\"p\",{style:err.exist?styleExists:{display:'none'}},\"Account already exists\"),React.createElement(InputGroup,{className:\"mb-3\",style:err.username?styleErr:{}},React.createElement(InputGroupAddon,{addonType:\"prepend\"},React.createElement(InputGroupText,null,React.createElement(\"i\",{className:\"icon-user\"}))),React.createElement(Input,{type:\"text\",placeholder:\"Username\",autoComplete:\"username\",value:account.username,onChange:function onChange(_ref){var value=_ref.target.value;setErr(function(prev){return _objectSpread({},prev,{exist:false});});setAccout(function(prev){return _objectSpread({},prev,{username:value});});setErr(function(prev){return _objectSpread({},prev,{username:false});});}})),React.createElement(InputGroup,{className:\"mb-3\",style:err.password?styleErr:{}},React.createElement(InputGroupAddon,{addonType:\"prepend\"},React.createElement(InputGroupText,null,React.createElement(\"i\",{className:\"icon-lock\"}))),React.createElement(Input,{type:\"password\",placeholder:\"Password\",autoComplete:\"new-password\",value:account.password,onChange:function onChange(_ref2){var value=_ref2.target.value;setAccout(function(prev){return _objectSpread({},prev,{password:value});});setErr(function(prev){return _objectSpread({},prev,{password:false});});}})),React.createElement(InputGroup,{className:\"mb-4\",style:err.password?styleErr:{}},React.createElement(InputGroupAddon,{addonType:\"prepend\"},React.createElement(InputGroupText,null,React.createElement(\"i\",{className:\"icon-lock\"}))),React.createElement(Input,{type:\"password\",placeholder:\"Repeat password\",autoComplete:\"new-password\",value:account.repPassword,onChange:function onChange(_ref3){var value=_ref3.target.value;setAccout(function(prev){return _objectSpread({},prev,{repPassword:value});});setErr(function(prev){return _objectSpread({},prev,{password:false});});}})),React.createElement(Button,{color:\"success\",block:true,onClick:handleRegister,disabled:disabled},\"Create Account\"))),React.createElement(CardFooter,{className:\"p-4\"},React.createElement(Row,null,React.createElement(Col,{xs:\"12\",sm:\"6\"},React.createElement(Button,{className:\"btn-facebook mb-1\",block:true},React.createElement(\"span\",null,\"facebook\"))),React.createElement(Col,{xs:\"12\",sm:\"6\"},React.createElement(Button,{className:\"btn-twitter mb-1\",block:true},React.createElement(\"span\",null,\"twitter\"))))))))));};export default Register;","map":{"version":3,"sources":["/Users/maidat/Desktop/untitled folder/persol-lqmb/src/views/Pages/Register/Register.js"],"names":["React","Component","useState","Button","Card","CardBody","CardFooter","Col","Container","Form","Input","InputGroup","InputGroupAddon","InputGroupText","Row","firebase","useHistory","styleErr","border","styleExists","color","display","sleep","time","Promise","resolve","setTimeout","Register","history","username","password","repPassword","win","lose","account","setAccout","err","setErr","disabled","setDisabled","handleRegister","e","prev","trim","ref","database","orderByChild","equalTo","on","snapshot","val","avatar","push","localStorage","setItem","JSON","stringify","exist","key","childData","value","target"],"mappings":"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","sourcesContent":["import React, { Component, useState } from \"react\";\nimport {\n  Button,\n  Card,\n  CardBody,\n  CardFooter,\n  Col,\n  Container,\n  Form,\n  Input,\n  InputGroup,\n  InputGroupAddon,\n  InputGroupText,\n  Row\n} from \"reactstrap\";\nimport firebase from \"./../../../config\";\nimport { useHistory } from \"react-router-dom\";\n\nconst styleErr = { border: \"1px solid #FF3300\" };\nconst styleExists = { color: '#FF3300', display: 'block' }\nfunction sleep(time) {\n  return new Promise(resolve => setTimeout(resolve, time));\n}\nconst Register = () => {\n  let history = useHistory();\n\n  const [account, setAccout] = useState({\n    username: \"\",\n    password: \"\",\n    repPassword: \"\",\n    win: 0,\n    lose: 0\n  });\n  const [err, setErr] = useState({});\n  const [disabled, setDisabled] = useState(false);\n\n  const handleRegister = async () => {\n    let e = false;\n    if (account.repPassword !== account.password || !account.password) {\n      setErr(prev => ({ ...prev, password: true }));\n      e = true;\n    }\n    if (!account.username && !account.username.trim()) {\n      setErr(prev => ({ ...prev, username: true }));\n      e = true;\n    }\n    if (e) return;\n    await setDisabled(true);\n\n    const ref = firebase.database();\n\n    ref\n      .ref(\"users\")\n      .orderByChild(\"username\")\n      .equalTo(account.username)\n      .on(\"value\", async snapshot => {\n        if (snapshot.val() === null) {\n          account.avatar = 'https://image.flaticon.com/icons/svg/2439/2439789.svg';\n          await setAccout(prev => { delete prev.repPassword; return prev });\n          ref.ref(\"users\").push(account);\n          localStorage.setItem('account', JSON.stringify(account));\n          history.push('/user/profile');\n        } else {\n          setErr(prev => ({ ...prev, exist: true }));\n          setDisabled(false)\n          var key = snapshot.key;\n          var childData = snapshot.val();\n        }\n      });\n    // firebase.database().ref('users').push(account);\n  };\n  return (\n    <div className=\"app flex-row align-items-center\">\n      <Container>\n        <Row className=\"justify-content-center\">\n          <Col md=\"9\" lg=\"7\" xl=\"6\">\n            <Card className=\"mx-4\">\n              <CardBody className=\"p-4\">\n                <Form>\n                  <h1>Register</h1>\n                  <p className=\"text-muted\">Create your account</p>\n                  <p style={err.exist ? styleExists : {display: 'none'} } >Account already exists</p>\n                  <InputGroup\n                    className=\"mb-3\"\n                    style={err.username ? styleErr : {}}\n                  >\n                    <InputGroupAddon addonType=\"prepend\">\n                      <InputGroupText>\n                        <i className=\"icon-user\"></i>\n                      </InputGroupText>\n                    </InputGroupAddon>\n                    <Input\n                      type=\"text\"\n                      placeholder=\"Username\"\n                      autoComplete=\"username\"\n                      value={account.username}\n                      onChange={({ target: { value } }) => {\n                        setErr(prev => ({ ...prev, exist: false }));\n                        setAccout(prev => ({ ...prev, username: value }));\n                        setErr(prev => ({ ...prev, username: false }));\n                      }}\n                    />\n                  </InputGroup>\n                  <InputGroup\n                    className=\"mb-3\"\n                    style={err.password ? styleErr : {}}\n                  >\n                    <InputGroupAddon addonType=\"prepend\">\n                      <InputGroupText>\n                        <i className=\"icon-lock\"></i>\n                      </InputGroupText>\n                    </InputGroupAddon>\n                    <Input\n                      type=\"password\"\n                      placeholder=\"Password\"\n                      autoComplete=\"new-password\"\n                      value={account.password}\n                      onChange={({ target: { value } }) => {\n                        setAccout(prev => ({ ...prev, password: value }));\n                        setErr(prev => ({ ...prev, password: false }));\n                      }}\n                    />\n                  </InputGroup>\n                  <InputGroup\n                    className=\"mb-4\"\n                    style={err.password ? styleErr : {}}\n                  >\n                    <InputGroupAddon addonType=\"prepend\">\n                      <InputGroupText>\n                        <i className=\"icon-lock\"></i>\n                      </InputGroupText>\n                    </InputGroupAddon>\n                    <Input\n                      type=\"password\"\n                      placeholder=\"Repeat password\"\n                      autoComplete=\"new-password\"\n                      value={account.repPassword}\n                      onChange={({ target: { value } }) => {\n                        setAccout(prev => ({ ...prev, repPassword: value }));\n                        setErr(prev => ({ ...prev, password: false }));\n                      }}\n                    />\n                  </InputGroup>\n                  <Button\n                    color=\"success\"\n                    block\n                    onClick={handleRegister}\n                    disabled={disabled}\n                  >\n                    Create Account\n                  </Button>\n                </Form>\n              </CardBody>\n              <CardFooter className=\"p-4\">\n                <Row>\n                  <Col xs=\"12\" sm=\"6\">\n                    <Button className=\"btn-facebook mb-1\" block>\n                      <span>facebook</span>\n                    </Button>\n                  </Col>\n                  <Col xs=\"12\" sm=\"6\">\n                    <Button className=\"btn-twitter mb-1\" block>\n                      <span>twitter</span>\n                    </Button>\n                  </Col>\n                </Row>\n              </CardFooter>\n            </Card>\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}
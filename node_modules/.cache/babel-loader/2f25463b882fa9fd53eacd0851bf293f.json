{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/maidat/Desktop/untitled folder/persol-lqmb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Card,CardBody,CardHeader,Col,Row,ListGroupItem,ListGroup,FormGroup,Label,Input,Button}from\"reactstrap\";import moment from\"moment\";import firebase from\"./../../config\";import{useHistory}from\"react-router-dom\";var OldMatch=function OldMatch(_ref){var oldMatch=_ref.oldMatch,changeStatusProgress=_ref.changeStatusProgress,reset=_ref.reset;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),matchs=_useState2[0],setMatchs=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),err=_useState4[0],setErr=_useState4[1];var ref=firebase.database();var history=useHistory();useEffect(function(){var tmp=false;for(var i=0;i<matchs.length;i++){for(var j in matchs[i]){if(matchs[i][j]===\"\"){tmp=true;break;}}if(tmp)break;}!!matchs.length?setErr(tmp):setErr(true);},[matchs]);var handleRenderMatch=function handleRenderMatch(_ref2){var value=_ref2.target.value;var statisticMatch=[];for(var i=0;i<value;i++){statisticMatch=[].concat(_toConsumableArray(statisticMatch),[{mvpWin:\"\",mvpLose:\"\",blueKill:\"\",redKill:\"\",win:\"\"}]);}setMatchs(statisticMatch);};var renderTeamPlayer=function renderTeamPlayer(nameTeam){if(nameTeam===\"blueTeam\"){return{win:oldMatch.blueTeam,lose:oldMatch.redTeam};}if(nameTeam===\"redTeam\"){return{win:oldMatch.redTeam,lose:oldMatch.blueTeam};}};var handleTeamWinStatics=function handleTeamWinStatics(value,match){setMatchs(function(prev){var newMatch=prev;newMatch[match]=_objectSpread({},newMatch[match],{},value);return JSON.parse(JSON.stringify(newMatch));});};var handleSaveHistory=function handleSaveHistory(){return _regeneratorRuntime.async(function handleSaveHistory$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(matchs.map(function(match){ref.ref(\"historyMatch\").push(_objectSpread({},match,{blueTeam:oldMatch.blueTeam,redTeam:oldMatch.redTeam,dateMatch:oldMatch.dateMatch,authorCreate:JSON.parse(localStorage.getItem(\"account\")).username,authorUpdate:\"\"}));var teamWin=oldMatch[match.win].map(function(i){return i.split(\" - \")[0];});var teamLose=oldMatch[match.win===\"blueTeam\"?\"redTeam\":\"blueTeam\"].map(function(i){return i.split(\" - \")[0];});ref.ref(\"users\").once(\"value\",function(snap){if(snap.val()!==null){var tmp=JSON.parse(JSON.stringify(snap.val()));Object.values(snap.val()).forEach(function(i,index){if(teamWin.includes(i.ingame.trim())){i=_objectSpread({},i,{win:parseInt(i.win)+1});}if(teamLose.includes(i.ingame.trim())){i=_objectSpread({},i,{lose:parseInt(i.lose)+1});}var key=Object.keys(snap.val())[index];tmp[key]=JSON.parse(JSON.stringify(i));});ref.ref(\"users\").update(tmp,function(){console.log('update done');});}});}));case 2:_context.next=4;return _regeneratorRuntime.awrap(ref.ref(\"historyRandom\").orderByValue().limitToLast(1).on(\"value\",function(snap){changeStatusProgress(false);if(snap.val()!==null){ref.ref().child(\"/historyRandom/\"+Object.keys(snap.val())[0]).update(_objectSpread({},oldMatch,{complete:true}),function(){console.log('update 2 done');});}}));case 4:setTimeout(window.location.reload(),500);case 5:case\"end\":return _context.stop();}}});};return React.createElement(Row,null,React.createElement(Col,{xs:\"12\"},React.createElement(Card,null,React.createElement(CardHeader,null,React.createElement(\"i\",{className:\"fa fa-align-justify\"}),\" Random match results on\",\" \",oldMatch.dateMatch),React.createElement(CardBody,null,React.createElement(Row,null,React.createElement(Col,{xs:12,sm:6},React.createElement(Card,null,React.createElement(CardHeader,null,React.createElement(\"strong\",null,\"Blue Team\")),React.createElement(CardBody,null,React.createElement(ListGroup,null,oldMatch.blueTeam.map(function(i){return React.createElement(ListGroupItem,{key:i},\" \",i,\" \");}))))),React.createElement(Col,{xs:12,sm:6},React.createElement(Card,null,React.createElement(CardHeader,null,React.createElement(\"strong\",null,\"Red Team\")),React.createElement(CardBody,null,React.createElement(ListGroup,null,oldMatch.redTeam.map(function(i){return React.createElement(ListGroupItem,{key:i},\" \",i,\" \");}))))),React.createElement(Col,{xs:12},React.createElement(FormGroup,null,React.createElement(Label,{htmlFor:\"NOM\"},\"Number of match:\"),React.createElement(Input,{type:\"text\",id:\"NOM\",placeholder:\"0\",onChange:handleRenderMatch}))),React.createElement(Col,{xs:12},!!matchs.length&&matchs.map(function(m,index){return React.createElement(Card,null,React.createElement(CardHeader,null,React.createElement(\"strong\",null,\"Match \",index+1,\":\")),React.createElement(CardBody,null,React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"Team win:\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"select\",name:\"select\",id:\"select\",onChange:function onChange(_ref3){var value=_ref3.target.value;return handleTeamWinStatics({win:value},index);}},React.createElement(\"option\",{value:\"\"},\"Please select\"),React.createElement(\"option\",{value:\"blueTeam\"},\"Blue Team\"),React.createElement(\"option\",{value:\"redTeam\"},\"Red Team\")))),!!m.win&&React.createElement(React.Fragment,null,React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"MVP team win:\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"select\",name:\"select\",id:\"select\",onChange:function onChange(_ref4){var value=_ref4.target.value;return handleTeamWinStatics({mvpWin:value},index);}},React.createElement(\"option\",{value:\"\"},\"Please select\"),renderTeamPlayer(m.win).win.map(function(i){return React.createElement(\"option\",{value:i},i);})))),React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"MVP team lose:\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"select\",name:\"select\",id:\"select\",onChange:function onChange(_ref5){var value=_ref5.target.value;return handleTeamWinStatics({mvpLose:value},index);}},React.createElement(\"option\",{value:\"\"},\"Please select\"),renderTeamPlayer(m.win).lose.map(function(i){return React.createElement(\"option\",{value:i},i);})))),React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"Blue team kill:\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"text\",name:\"select\",id:\"select\",placeholder:\"0\",onChange:function onChange(_ref6){var value=_ref6.target.value;return handleTeamWinStatics({blueKill:value},index);}}))),React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"Red team kill:\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"text\",name:\"select\",id:\"select\",placeholder:\"0\",onChange:function onChange(_ref7){var value=_ref7.target.value;return handleTeamWinStatics({redKill:value},index);}}))),React.createElement(FormGroup,{row:true},React.createElement(Col,{md:\"3\"},React.createElement(Label,{htmlFor:\"select\"},\"Time to play (integer):\")),React.createElement(Col,{xs:\"12\",md:\"9\"},React.createElement(Input,{type:\"text\",name:\"select\",id:\"select\",placeholder:\"15\",onChange:function onChange(_ref8){var value=_ref8.target.value;return handleTeamWinStatics({timeToPlay:value},index);}}))))));}))),React.createElement(Row,null,React.createElement(Col,{col:\"6\",sm:\"4\",md:\"3\",xl:\"2\",className:\"mb-3 mb-xl-0\"},React.createElement(Button,{block:true,color:\"success\",onClick:handleSaveHistory,disabled:err},\"Save\")))))));};export default OldMatch;","map":{"version":3,"sources":["/Users/maidat/Desktop/untitled folder/persol-lqmb/src/components/Random/OldMatch.js"],"names":["React","useState","useEffect","Card","CardBody","CardHeader","Col","Row","ListGroupItem","ListGroup","FormGroup","Label","Input","Button","moment","firebase","useHistory","OldMatch","oldMatch","changeStatusProgress","reset","matchs","setMatchs","err","setErr","ref","database","history","tmp","i","length","j","handleRenderMatch","value","target","statisticMatch","mvpWin","mvpLose","blueKill","redKill","win","renderTeamPlayer","nameTeam","blueTeam","lose","redTeam","handleTeamWinStatics","match","prev","newMatch","JSON","parse","stringify","handleSaveHistory","map","push","dateMatch","authorCreate","localStorage","getItem","username","authorUpdate","teamWin","split","teamLose","once","snap","val","Object","values","forEach","index","includes","ingame","trim","parseInt","key","keys","update","console","log","orderByValue","limitToLast","on","child","complete","setTimeout","window","location","reload","m","timeToPlay"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  Card,\n  CardBody,\n  CardHeader,\n  Col,\n  Row,\n  ListGroupItem,\n  ListGroup,\n  FormGroup,\n  Label,\n  Input,\n  Button\n} from \"reactstrap\";\nimport moment from \"moment\";\nimport firebase from \"./../../config\";\nimport { useHistory } from \"react-router-dom\";\n\nconst OldMatch = ({ oldMatch, changeStatusProgress, reset }) => {\n  const [matchs, setMatchs] = useState([]);\n  const [err, setErr] = useState(true);\n  const ref = firebase.database();\n  const history = useHistory();\n\n  useEffect(() => {\n    let tmp = false;\n    for (let i = 0; i < matchs.length; i++) {\n      for (let j in matchs[i]) {\n        if (matchs[i][j] === \"\") {\n          tmp = true;\n          break;\n        }\n      }\n      if (tmp) break;\n    }\n    !!matchs.length ? setErr(tmp) : setErr(true);\n  }, [matchs]);\n\n  const handleRenderMatch = ({ target: { value } }) => {\n    let statisticMatch = [];\n    for (let i = 0; i < value; i++) {\n      statisticMatch = [\n        ...statisticMatch,\n        {\n          mvpWin: \"\",\n          mvpLose: \"\",\n          blueKill: \"\",\n          redKill: \"\",\n          win: \"\"\n        }\n      ];\n    }\n    setMatchs(statisticMatch);\n  };\n\n  const renderTeamPlayer = nameTeam => {\n    if (nameTeam === \"blueTeam\") {\n      return { win: oldMatch.blueTeam, lose: oldMatch.redTeam };\n    }\n    if (nameTeam === \"redTeam\") {\n      return { win: oldMatch.redTeam, lose: oldMatch.blueTeam };\n    }\n  };\n\n  const handleTeamWinStatics = (value, match) => {\n    setMatchs(prev => {\n      let newMatch = prev;\n      newMatch[match] = { ...newMatch[match], ...value };\n      return JSON.parse(JSON.stringify(newMatch));\n    });\n  };\n  const handleSaveHistory = async () => {\n    await matchs.map(match => {\n      ref.ref(\"historyMatch\").push({\n        ...match,\n        blueTeam: oldMatch.blueTeam,\n        redTeam: oldMatch.redTeam,\n        dateMatch: oldMatch.dateMatch,\n        authorCreate: JSON.parse(localStorage.getItem(\"account\")).username,\n        authorUpdate: \"\"\n      });\n\n      const teamWin = oldMatch[match.win].map(i => i.split(\" - \")[0]);\n      const teamLose = oldMatch[\n        match.win === \"blueTeam\" ? \"redTeam\" : \"blueTeam\"\n      ].map(i => i.split(\" - \")[0]);\n      ref.ref(\"users\").once(\"value\", snap => {\n        if (snap.val() !== null) {\n          const tmp = JSON.parse(JSON.stringify(snap.val()));\n          Object.values(snap.val()).forEach((i, index) => {\n            if (teamWin.includes(i.ingame.trim())) {\n              i = { ...i, win: parseInt(i.win) + 1 };\n            }\n            if (teamLose.includes(i.ingame.trim())) {\n              i = { ...i, lose: parseInt(i.lose) + 1 };\n            }\n            const key = Object.keys(snap.val())[index];\n            tmp[key] = JSON.parse(JSON.stringify(i));\n          });\n          ref.ref(\"users\").update(tmp, () => { console.log('update done')})\n        }\n      });\n    });\n\n    await ref\n      .ref(\"historyRandom\")\n      .orderByValue()\n      .limitToLast(1)\n      .on(\"value\", snap => {\n        changeStatusProgress(false);\n        if (snap.val() !== null) {\n          ref\n            .ref()\n            .child(\"/historyRandom/\" + Object.keys(snap.val())[0])\n            .update({\n              ...oldMatch,\n              complete: true\n            }, () => { console.log('update 2 done' )});\n        }\n      });\n    setTimeout(window.location.reload(), 500);\n  };\n\n  return (\n    <Row>\n      <Col xs=\"12\">\n        <Card>\n          <CardHeader>\n            <i className=\"fa fa-align-justify\"></i> Random match results on{\" \"}\n            {oldMatch.dateMatch}\n          </CardHeader>\n          <CardBody>\n            <Row>\n              <Col xs={12} sm={6}>\n                <Card>\n                  <CardHeader>\n                    <strong>Blue Team</strong>\n                  </CardHeader>\n                  <CardBody>\n                    <ListGroup>\n                      {oldMatch.blueTeam.map(i => {\n                        return <ListGroupItem key={i}> {i} </ListGroupItem>;\n                      })}\n                    </ListGroup>\n                  </CardBody>\n                </Card>\n              </Col>\n              <Col xs={12} sm={6}>\n                <Card>\n                  <CardHeader>\n                    <strong>Red Team</strong>\n                  </CardHeader>\n                  <CardBody>\n                    <ListGroup>\n                      {oldMatch.redTeam.map(i => {\n                        return <ListGroupItem key={i}> {i} </ListGroupItem>;\n                      })}\n                    </ListGroup>\n                  </CardBody>\n                </Card>\n              </Col>\n              <Col xs={12}>\n                <FormGroup>\n                  <Label htmlFor=\"NOM\">Number of match:</Label>\n                  <Input\n                    type=\"text\"\n                    id=\"NOM\"\n                    placeholder=\"0\"\n                    onChange={handleRenderMatch}\n                  />\n                </FormGroup>\n              </Col>\n              <Col xs={12}>\n                {!!matchs.length &&\n                  matchs.map((m, index) => (\n                    <Card>\n                      <CardHeader>\n                        <strong>Match {index + 1}:</strong>\n                      </CardHeader>\n                      <CardBody>\n                        <FormGroup row>\n                          <Col md=\"3\">\n                            <Label htmlFor=\"select\">Team win:</Label>\n                          </Col>\n                          <Col xs=\"12\" md=\"9\">\n                            <Input\n                              type=\"select\"\n                              name=\"select\"\n                              id=\"select\"\n                              onChange={({ target: { value } }) =>\n                                handleTeamWinStatics({ win: value }, index)\n                              }\n                            >\n                              <option value=\"\">Please select</option>\n                              <option value=\"blueTeam\">Blue Team</option>\n                              <option value=\"redTeam\">Red Team</option>\n                            </Input>\n                          </Col>\n                        </FormGroup>\n                        {!!m.win && (\n                          <>\n                            <FormGroup row>\n                              <Col md=\"3\">\n                                <Label htmlFor=\"select\">MVP team win:</Label>\n                              </Col>\n                              <Col xs=\"12\" md=\"9\">\n                                <Input\n                                  type=\"select\"\n                                  name=\"select\"\n                                  id=\"select\"\n                                  onChange={({ target: { value } }) =>\n                                    handleTeamWinStatics(\n                                      { mvpWin: value },\n                                      index\n                                    )\n                                  }\n                                >\n                                  <option value=\"\">Please select</option>\n                                  {renderTeamPlayer(m.win).win.map(i => (\n                                    <option value={i}>{i}</option>\n                                  ))}\n                                </Input>\n                              </Col>\n                            </FormGroup>\n                            <FormGroup row>\n                              <Col md=\"3\">\n                                <Label htmlFor=\"select\">MVP team lose:</Label>\n                              </Col>\n                              <Col xs=\"12\" md=\"9\">\n                                <Input\n                                  type=\"select\"\n                                  name=\"select\"\n                                  id=\"select\"\n                                  onChange={({ target: { value } }) =>\n                                    handleTeamWinStatics(\n                                      { mvpLose: value },\n                                      index\n                                    )\n                                  }\n                                >\n                                  <option value=\"\">Please select</option>\n                                  {renderTeamPlayer(m.win).lose.map(i => (\n                                    <option value={i}>{i}</option>\n                                  ))}\n                                </Input>\n                              </Col>\n                            </FormGroup>\n                            <FormGroup row>\n                              <Col md=\"3\">\n                                <Label htmlFor=\"select\">Blue team kill:</Label>\n                              </Col>\n                              <Col xs=\"12\" md=\"9\">\n                                <Input\n                                  type=\"text\"\n                                  name=\"select\"\n                                  id=\"select\"\n                                  placeholder=\"0\"\n                                  onChange={({ target: { value } }) =>\n                                    handleTeamWinStatics(\n                                      { blueKill: value },\n                                      index\n                                    )\n                                  }\n                                />\n                              </Col>\n                            </FormGroup>\n                            <FormGroup row>\n                              <Col md=\"3\">\n                                <Label htmlFor=\"select\">Red team kill:</Label>\n                              </Col>\n                              <Col xs=\"12\" md=\"9\">\n                                <Input\n                                  type=\"text\"\n                                  name=\"select\"\n                                  id=\"select\"\n                                  placeholder=\"0\"\n                                  onChange={({ target: { value } }) =>\n                                    handleTeamWinStatics(\n                                      { redKill: value },\n                                      index\n                                    )\n                                  }\n                                />\n                              </Col>\n                            </FormGroup>\n                            <FormGroup row>\n                              <Col md=\"3\">\n                                <Label htmlFor=\"select\">Time to play (integer):</Label>\n                              </Col>\n                              <Col xs=\"12\" md=\"9\">\n                                <Input\n                                  type=\"text\"\n                                  name=\"select\"\n                                  id=\"select\"\n                                  placeholder=\"15\"\n                                  onChange={({ target: { value } }) =>\n                                    handleTeamWinStatics(\n                                      { timeToPlay: value },\n                                      index\n                                    )\n                                  }\n                                />\n                              </Col>\n                            </FormGroup>\n                          </>\n                        )}\n                      </CardBody>\n                    </Card>\n                  ))}\n              </Col>\n            </Row>\n            <Row>\n              <Col col=\"6\" sm=\"4\" md=\"3\" xl=\"2\" className=\"mb-3 mb-xl-0\">\n                <Button\n                  block\n                  color=\"success\"\n                  onClick={handleSaveHistory}\n                  disabled={err}\n                >\n                  Save\n                </Button>\n              </Col>\n            </Row>\n          </CardBody>\n        </Card>\n      </Col>\n    </Row>\n  );\n};\n\nexport default OldMatch;\n"]},"metadata":{},"sourceType":"module"}